

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>decocare.history &mdash; insulaudit:decoding-carelink 0.0.3 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="insulaudit:decoding-carelink 0.0.3 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">insulaudit:decoding-carelink 0.0.3 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for decocare.history</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides some basic helper/formatting utilities,</span>
<span class="sd">specifically targeted at decoding ReadHistoryData data.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">hexlify</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">import</span> <span class="nn">lib</span>

<div class="viewcode-block" id="NotADate"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.NotADate">[docs]</a><span class="k">class</span> <span class="nc">NotADate</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span> <span class="k">pass</span>
</div>
<div class="viewcode-block" id="Mask"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Mask">[docs]</a><span class="k">class</span> <span class="nc">Mask</span><span class="p">:</span>
  <span class="n">time</span>   <span class="o">=</span> <span class="mh">0xC0</span>
  <span class="n">invert</span> <span class="o">=</span> <span class="mh">0x3F</span>
  <span class="n">year</span>   <span class="o">=</span> <span class="mh">0x0F</span>
  <span class="n">day</span>    <span class="o">=</span> <span class="mh">0x1F</span>

</div>
<div class="viewcode-block" id="quick_hex"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.quick_hex">[docs]</a><span class="k">def</span> <span class="nf">quick_hex</span><span class="p">(</span><span class="n">bb</span><span class="p">):</span>
  <span class="k">return</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="s">&#39;</span><span class="si">%#04x</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bb</span> <span class="p">]</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="parse_seconds"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_seconds">[docs]</a><span class="k">def</span> <span class="nf">parse_seconds</span><span class="p">(</span><span class="n">sec</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; parse_seconds(0x92)</span>
<span class="sd">  18</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">sec</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">invert</span>
</div>
<div class="viewcode-block" id="parse_minutes"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_minutes">[docs]</a><span class="k">def</span> <span class="nf">parse_minutes</span><span class="p">(</span><span class="n">minutes</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; parse_minutes(0x9e)</span>
<span class="sd">  30</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">minutes</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">invert</span>

</div>
<div class="viewcode-block" id="parse_hours"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_hours">[docs]</a><span class="k">def</span> <span class="nf">parse_hours</span><span class="p">(</span><span class="n">hours</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; parse_hours(0x0b)</span>
<span class="sd">  11</span>

<span class="sd">  &gt;&gt;&gt; parse_hours(0x28)</span>
<span class="sd">  8</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">hours</span> <span class="o">&amp;</span> <span class="mh">0x1f</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="parse_day"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_day">[docs]</a><span class="k">def</span> <span class="nf">parse_day</span><span class="p">(</span><span class="n">day</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; parse_day( 0x01 )</span>
<span class="sd">  1</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">day</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">day</span>
</div>
<div class="viewcode-block" id="parse_months"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_months">[docs]</a><span class="k">def</span> <span class="nf">parse_months</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="n">minutes</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; parse_months( 0x92, 0x9e )</span>
<span class="sd">  10</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">seconds</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>
  <span class="n">low</span>  <span class="o">=</span> <span class="p">(</span><span class="n">minutes</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span>
  <span class="k">return</span> <span class="n">high</span> <span class="o">|</span> <span class="n">low</span>
</div>
<div class="viewcode-block" id="parse_years_lax"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_years_lax">[docs]</a><span class="k">def</span> <span class="nf">parse_years_lax</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
  <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">year</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2000</span>
  <span class="k">return</span> <span class="n">y</span>

</div>
<span class="n">_remote_ids</span> <span class="o">=</span> <span class="p">[</span>
  <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0x40</span> <span class="p">]),</span>
  <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x2a</span> <span class="p">]),</span>
  <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x92</span> <span class="p">]),</span>
<span class="p">]</span>

<div class="viewcode-block" id="decode_remote_id"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.decode_remote_id">[docs]</a><span class="k">def</span> <span class="nf">decode_remote_id</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   0x27</span>
<span class="sd">   0x01 0xe2 0x40</span>
<span class="sd">   0x03 0x42 0x2a</span>
<span class="sd">   0x28 0x0c 0x89</span>
<span class="sd">   0x92 0x00 0x00 0x00</span>

<span class="sd">  &gt;&gt;&gt; decode_remote_id(_remote_ids[0])</span>
<span class="sd">  &#39;123456&#39;</span>

<span class="sd">  &gt;&gt;&gt; decode_remote_id(_remote_ids[1])</span>
<span class="sd">  &#39;213546&#39;</span>

<span class="sd">  &gt;&gt;&gt; decode_remote_id(_remote_ids[2])</span>
<span class="sd">  &#39;821650&#39;</span>



<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">high</span>   <span class="o">=</span> <span class="n">msg</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span>
  <span class="n">middle</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
  <span class="n">low</span>    <span class="o">=</span> <span class="n">msg</span><span class="p">[</span> <span class="mi">2</span> <span class="p">]</span>
  <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">high</span> <span class="o">+</span> <span class="n">middle</span> <span class="o">+</span> <span class="n">low</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="extra_year_bits"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.extra_year_bits">[docs]</a><span class="k">def</span> <span class="nf">extra_year_bits</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mh">0x86</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; extra_year_bits( )</span>
<span class="sd">  [1, 0, 0, 0]</span>

<span class="sd">  &gt;&gt;&gt; extra_year_bits(0x06)</span>
<span class="sd">  [0, 0, 0, 0]</span>

<span class="sd">  &gt;&gt;&gt; extra_year_bits(0x86)</span>
<span class="sd">  [1, 0, 0, 0]</span>

<span class="sd">  &gt;&gt;&gt; extra_year_bits(0x46)</span>
<span class="sd">  [0, 1, 0, 0]</span>

<span class="sd">  &gt;&gt;&gt; extra_year_bits(0x26)</span>
<span class="sd">  [0, 0, 1, 0]</span>

<span class="sd">  &gt;&gt;&gt; extra_year_bits(0x16)</span>
<span class="sd">  [0, 0, 0, 1]</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># year = year[0]</span>
  <span class="n">masks</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mh">0x40</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mh">0x20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mh">0x10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">]</span>
  <span class="n">nibbles</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
  <span class="k">for</span> <span class="n">mask</span><span class="p">,</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">masks</span><span class="p">:</span>
    <span class="n">nibbles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">year</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span> <span class="p">)</span> <span class="p">)</span>
  <span class="k">return</span> <span class="n">nibbles</span>
  </div>
<div class="viewcode-block" id="extra_hour_bits"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.extra_hour_bits">[docs]</a><span class="k">def</span> <span class="nf">extra_hour_bits</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; extra_hour_bits(0x28)</span>
<span class="sd">  [0, 0, 1]</span>

<span class="sd">  &gt;&gt;&gt; extra_hour_bits(0x8)</span>
<span class="sd">  [0, 0, 0]</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">masks</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mh">0x40</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mh">0x20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">]</span>
  <span class="n">nibbles</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
  <span class="k">for</span> <span class="n">mask</span><span class="p">,</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">masks</span><span class="p">:</span>
    <span class="n">nibbles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">value</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span> <span class="p">)</span> <span class="p">)</span>
  <span class="k">return</span> <span class="n">nibbles</span>
  </div>
<div class="viewcode-block" id="parse_years"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_years">[docs]</a><span class="k">def</span> <span class="nf">parse_years</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &gt;&gt;&gt; parse_years(0x06)</span>
<span class="sd">    2006</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># if year &gt; 0x80:</span>
  <span class="c">#  year = year - 0x80</span>
  <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">year</span> <span class="o">&amp;</span> <span class="n">Mask</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2000</span>
  <span class="c"># if y &lt; 0 or y &lt; 1999 or y &gt; 2015:</span>
  <span class="c">#   raise ValueError(y)</span>
  <span class="k">return</span> <span class="n">y</span>
</div>
<div class="viewcode-block" id="encode_year"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.encode_year">[docs]</a><span class="k">def</span> <span class="nf">encode_year</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
  <span class="k">pass</span>
</div>
<div class="viewcode-block" id="encode_monthbyte"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.encode_monthbyte">[docs]</a><span class="k">def</span> <span class="nf">encode_monthbyte</span><span class="p">(</span><span class="n">sec</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; encode_monthbyte( ) == bytearray(b&#39;\x92\x9e&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; quick_hex(encode_monthbyte( ))</span>
<span class="sd">  &#39;0x92 0x9e&#39;</span>

<span class="sd">  &gt;&gt;&gt; encode_monthbyte(sec=10) == bytearray(b&#39;\x8a\x9e&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; encode_monthbyte(sec=35) == bytearray(b&#39;\xa3\x9e&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; encode_monthbyte(sec=50) == bytearray(b&#39;\xb2\x9e&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; encode_monthbyte(minute=10) == bytearray(b&#39;\x92\x8a&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; encode_monthbyte(minute=35) == bytearray(b&#39;\x92\xa3&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; encode_monthbyte(minute=50) == bytearray(b&#39;\x92\xb2&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">encoded</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span> <span class="p">]</span>


  <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">month</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x3</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span>
  <span class="n">low</span>  <span class="o">=</span> <span class="n">month</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x3</span><span class="p">)</span>

  <span class="n">encoded</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sec</span> <span class="o">|</span> <span class="p">(</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
  <span class="n">encoded</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">minute</span> <span class="o">|</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
  <span class="k">return</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="n">encoded</span> <span class="p">)</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;0x</span><span class="si">%.2x</span><span class="s"> 0x</span><span class="si">%.2x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</div>
<div class="viewcode-block" id="encode_minute"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.encode_minute">[docs]</a><span class="k">def</span> <span class="nf">encode_minute</span><span class="p">(</span><span class="n">minute</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; quick_hex(encode_minute( ))</span>
<span class="sd">  &#39;0x9e&#39;</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">low</span>  <span class="o">=</span> <span class="n">month</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x3</span><span class="p">)</span>
  <span class="n">encoded</span> <span class="o">=</span> <span class="n">minute</span> <span class="o">|</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
  <span class="k">return</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">[</span> <span class="n">encoded</span> <span class="p">]</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="encode_second"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.encode_second">[docs]</a><span class="k">def</span> <span class="nf">encode_second</span><span class="p">(</span><span class="n">sec</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; encode_second( ) == bytearray(b&#39;\x92&#39;)</span>
<span class="sd">  True</span>

<span class="sd">  &gt;&gt;&gt; quick_hex(encode_second( ))</span>
<span class="sd">  &#39;0x92&#39;</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">month</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x3</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span>
  <span class="n">encoded</span> <span class="o">=</span> <span class="n">sec</span> <span class="o">|</span> <span class="p">(</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
  <span class="k">return</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">[</span> <span class="n">encoded</span> <span class="p">]</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="test_time_encoders"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.test_time_encoders">[docs]</a><span class="k">def</span> <span class="nf">test_time_encoders</span><span class="p">(</span> <span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; test_time_encoders( )</span>
<span class="sd">  True</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">one</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">encode_second</span><span class="p">(</span> <span class="p">),</span> <span class="n">encode_minute</span><span class="p">(</span> <span class="p">)])</span>
  <span class="n">two</span> <span class="o">=</span> <span class="n">encode_monthbyte</span><span class="p">(</span> <span class="p">)</span>
  <span class="k">return</span> <span class="n">one</span> <span class="o">==</span> <span class="n">two</span>
</div>
<div class="viewcode-block" id="unmask_date"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.unmask_date">[docs]</a><span class="k">def</span> <span class="nf">unmask_date</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Extract date values from a series of bytes.</span>

<span class="sd">  Returns 6-tuple of scalar values year, month, day, hours, minutes,</span>
<span class="sd">  seconds.</span>
<span class="sd">  &gt;&gt;&gt; unmask_date(bytearray( [ 0x6f, 0xd7, 0x08, 0x01, 0x06 ] ))</span>
<span class="sd">  (2006, 7, 1, 8, 23, 47)</span>

<span class="sd">  &gt;&gt;&gt; unmask_date( bytearray( [ 0x00 ] * 5 ))</span>
<span class="sd">  (2000, 0, 0, 0, 0, 0)</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:]</span>
  <span class="n">seconds</span> <span class="o">=</span> <span class="n">parse_seconds</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">minutes</span> <span class="o">=</span> <span class="n">parse_minutes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

  <span class="n">hours</span>   <span class="o">=</span> <span class="n">parse_hours</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
  <span class="n">day</span>     <span class="o">=</span> <span class="n">parse_day</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
  <span class="n">year</span>    <span class="o">=</span> <span class="n">parse_years</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

  <span class="n">month</span>   <span class="o">=</span> <span class="n">parse_months</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="parse_date"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_date">[docs]</a><span class="k">def</span> <span class="nf">parse_date</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">loose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">parse_date_strict</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
  <span class="k">except</span> <span class="n">NotADate</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
      <span class="k">raise</span>
    <span class="k">if</span> <span class="n">loose</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">unmask_date</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

  <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="parse_date_strict"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_date_strict">[docs]</a><span class="k">def</span> <span class="nf">parse_date_strict</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Apply strict datetime validation to extract a datetime from a series</span>
<span class="sd">  of bytes.</span>
<span class="sd">  &gt;&gt;&gt; parse_date(bytearray( [ 0x6f, 0xd7, 0x08, 0x01, 0x06 ] )).isoformat( )</span>
<span class="sd">  &#39;2006-07-01T08:23:47&#39;</span>


<span class="sd">  &quot;&quot;&quot;</span>
  <span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span> <span class="o">=</span> <span class="n">unmask_date</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">date</span>
  <span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">NotADate</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Base"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Base">[docs]</a><span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &gt;&gt;&gt; str( Base( bytearray([ 0x00, 0x00 ]) ) )</span>
<span class="sd">    &#39;Base unknown head[2], body[0] op[0x00]&#39;</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">head_length</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">body_length</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">date_length</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">)):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bolus</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">head</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">)</span>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
    <span class="n">lengths</span> <span class="o">=</span> <span class="s">&#39;head[{}], body[{}]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>
    <span class="c"># opcodes = &#39; &#39;.join([&#39;%#04x&#39; % x for x in self.head[:1]])</span>
    <span class="n">opcodes</span> <span class="o">=</span> <span class="s">&#39;op[</span><span class="si">%#04x</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span>
    <span class="k">return</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_str</span><span class="p">(</span> <span class="p">),</span> <span class="n">lengths</span><span class="p">,</span> <span class="n">opcodes</span> <span class="p">])</span>

<div class="viewcode-block" id="Base.date_str"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Base.date_str">[docs]</a>  <span class="k">def</span> <span class="nf">date_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s">&#39;unknown&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unmask_date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
</div>
<div class="viewcode-block" id="Base.parse"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Base.parse">[docs]</a>  <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolus</span><span class="p">):</span>
    <span class="n">head_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span>
    <span class="n">date_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_length</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">bolus</span>  <span class="o">=</span> <span class="n">bolus</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">head</span>   <span class="o">=</span> <span class="n">bolus</span><span class="p">[:</span><span class="n">head_length</span><span class="p">]</span>
    <span class="n">body_offset</span> <span class="o">=</span> <span class="n">head_length</span> <span class="o">+</span> <span class="n">date_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date</span>   <span class="o">=</span> <span class="n">bolus</span><span class="p">[</span><span class="n">head_length</span><span class="p">:</span><span class="n">body_offset</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body</span>   <span class="o">=</span> <span class="n">bolus</span><span class="p">[</span><span class="n">body_offset</span><span class="p">:]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="Base.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Base.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">pass</span>
</div>
<div class="viewcode-block" id="Base.pformat"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Base.pformat">[docs]</a>  <span class="k">def</span> <span class="nf">pformat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="n">head</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s">&quot;    op hex (</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">),</span> <span class="n">lib</span><span class="o">.</span><span class="n">hexdump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                       <span class="s">&quot;    decimal&quot;</span><span class="p">,</span> <span class="n">lib</span><span class="o">.</span><span class="n">int_dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span> <span class="p">])</span>
    <span class="n">date</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s">&quot;    datetime (</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_str</span><span class="p">(</span> <span class="p">),</span>
                       <span class="n">lib</span><span class="o">.</span><span class="n">hexdump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="p">])</span>

    <span class="n">body</span> <span class="o">=</span> <span class="s">&quot;    body (</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">body</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="n">body</span><span class="p">,</span>
                         <span class="s">&quot;    hex&quot;</span><span class="p">,</span> <span class="n">lib</span><span class="o">.</span><span class="n">hexdump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                         <span class="s">&quot;    decimal&quot;</span><span class="p">,</span> <span class="n">lib</span><span class="o">.</span><span class="n">int_dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span> <span class="p">])</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
    <span class="n">hour_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="ow">and</span> <span class="n">extra_hour_bits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">[</span> <span class="p">]</span>
    <span class="n">year_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="ow">and</span> <span class="n">extra_year_bits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="ow">or</span> <span class="p">[</span> <span class="p">]</span>
    <span class="n">day_bits</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span> <span class="ow">and</span> <span class="n">extra_hour_bits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="ow">or</span> <span class="p">[</span> <span class="p">]</span>
    <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">hour_bits</span><span class="p">:</span>
      <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;HOUR BITS: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">hour_bits</span><span class="p">)))</span>
    <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">day_bits</span><span class="p">:</span>
      <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;DAY BITS: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">day_bits</span><span class="p">)))</span>
    <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">year_bits</span><span class="p">:</span>
      <span class="n">extra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;YEAR BITS: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_bits</span><span class="p">)))</span>
    <span class="n">decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">decode_msg</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">decoded</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">decode_msg</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s">&#39;###### DECODED&#39;</span><span class="p">,</span>
                               <span class="s">&#39;```python&#39;</span><span class="p">,</span>
                               <span class="s">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span> <span class="p">))),</span>
                               <span class="s">&#39;```&#39;</span><span class="p">,</span> <span class="p">])</span>
    <span class="k">if</span> <span class="n">extra</span><span class="p">:</span>
      <span class="n">extra</span> <span class="o">=</span> <span class="s">&#39;    &#39;</span> <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">extra</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">decode_msg</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">extra</span> <span class="p">])</span>

</div></div>
<div class="viewcode-block" id="VariableHead"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.VariableHead">[docs]</a><span class="k">class</span> <span class="nc">VariableHead</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">):</span>
    <span class="n">Base</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="KnownRecord"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.KnownRecord">[docs]</a><span class="k">class</span> <span class="nc">KnownRecord</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x00</span>
  <span class="n">decodes_date</span> <span class="o">=</span> <span class="bp">True</span>

<div class="viewcode-block" id="KnownRecord.parse_time"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.KnownRecord.parse_time">[docs]</a>  <span class="k">def</span> <span class="nf">parse_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="KnownRecord.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.KnownRecord.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
</div></div>
<span class="n">_known</span> <span class="o">=</span> <span class="p">{</span>

<span class="p">}</span>

<div class="viewcode-block" id="InvalidRecord"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.InvalidRecord">[docs]</a><span class="k">class</span> <span class="nc">InvalidRecord</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="k">pass</span>
  <span class="c"># 0x0c: 22,</span>
  <span class="c"># 0x6d: 46,</span>
  <span class="c"># 0x6d: 46 - 5,</span>
</div>
<div class="viewcode-block" id="Prime"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Prime">[docs]</a><span class="k">class</span> <span class="nc">Prime</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x03</span>
  <span class="n">head_length</span> <span class="o">=</span> <span class="mi">5</span>
<div class="viewcode-block" id="Prime.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Prime.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">/</span> <span class="mf">10.0</span>
    <span class="n">fixed</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="mf">10.0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s">&#39;manual&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fixed</span><span class="p">,</span> <span class="s">&#39;fixed&#39;</span><span class="p">)</span>
    <span class="n">prime</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
              <span class="s">&#39;amount&#39;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
              <span class="s">&#39;fixed&#39;</span><span class="p">:</span> <span class="n">fixed</span><span class="p">,</span> <span class="p">}</span>
    <span class="k">return</span> <span class="n">prime</span>
</div></div>
<div class="viewcode-block" id="NoDelivery"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.NoDelivery">[docs]</a><span class="k">class</span> <span class="nc">NoDelivery</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x06</span>
  <span class="n">head_length</span> <span class="o">=</span> <span class="mi">4</span></div>
<div class="viewcode-block" id="ResultTotals"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ResultTotals">[docs]</a><span class="k">class</span> <span class="nc">ResultTotals</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x07</span>
  <span class="n">head_length</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">body_length</span> <span class="o">=</span> <span class="mi">38</span> <span class="o">+</span> <span class="mi">3</span>
</div>
<div class="viewcode-block" id="ChangeBasalProfile"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ChangeBasalProfile">[docs]</a><span class="k">class</span> <span class="nc">ChangeBasalProfile</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x08</span>
  <span class="n">body_length</span> <span class="o">=</span> <span class="mi">42</span></div>
<div class="viewcode-block" id="ClearAlarm"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ClearAlarm">[docs]</a><span class="k">class</span> <span class="nc">ClearAlarm</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x0C</span></div>
<div class="viewcode-block" id="SelectBasalProfile"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.SelectBasalProfile">[docs]</a><span class="k">class</span> <span class="nc">SelectBasalProfile</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x14</span></div>
<div class="viewcode-block" id="ChangeTime"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ChangeTime">[docs]</a><span class="k">class</span> <span class="nc">ChangeTime</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x17</span></div>
<div class="viewcode-block" id="NewTimeSet"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.NewTimeSet">[docs]</a><span class="k">class</span> <span class="nc">NewTimeSet</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x18</span></div>
<div class="viewcode-block" id="LowBattery"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.LowBattery">[docs]</a><span class="k">class</span> <span class="nc">LowBattery</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x19</span></div>
<div class="viewcode-block" id="Battery"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Battery">[docs]</a><span class="k">class</span> <span class="nc">Battery</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x1a</span></div>
<div class="viewcode-block" id="PumpSuspend"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.PumpSuspend">[docs]</a><span class="k">class</span> <span class="nc">PumpSuspend</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x1e</span></div>
<div class="viewcode-block" id="PumpResume"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.PumpResume">[docs]</a><span class="k">class</span> <span class="nc">PumpResume</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x1f</span>
</div>
<div class="viewcode-block" id="CalBGForPH"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.CalBGForPH">[docs]</a><span class="k">class</span> <span class="nc">CalBGForPH</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &gt;&gt;&gt; rec = CalBGForPH( CalBGForPH._test_1[:2] )</span>
<span class="sd">    &gt;&gt;&gt; rec.parse( CalBGForPH._test_1 )</span>
<span class="sd">    {&#39;amount&#39;: 139}</span>
<span class="sd">    &gt;&gt;&gt; print str(rec)</span>
<span class="sd">    CalBGForPH 2012-12-18T15:04:46 head[2], body[0] op[0x0a]</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span>
                        <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="p">])</span>

  <span class="n">_test_2</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span>
                        <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="p">])</span>

  <span class="n">_test_3</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span>
                        <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="p">])</span>

  <span class="n">_test_4</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span>
                        <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="p">])</span>

  <span class="n">_test_5</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span>
                        <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="p">])</span>
  <span class="n">_test_6</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span>
                        <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="p">])</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x0a</span>
<div class="viewcode-block" id="CalBGForPH.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.CalBGForPH.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">year_bits</span> <span class="o">=</span> <span class="n">extra_year_bits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

    <span class="k">return</span> <span class="p">{</span> <span class="s">&#39;amount&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">BangInt</span><span class="p">([</span> <span class="n">year_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]))</span> <span class="p">}</span>
    <span class="k">pass</span>
</div></div>
<div class="viewcode-block" id="Rewind"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Rewind">[docs]</a><span class="k">class</span> <span class="nc">Rewind</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x21</span></div>
<div class="viewcode-block" id="EnableDisableRemote"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.EnableDisableRemote">[docs]</a><span class="k">class</span> <span class="nc">EnableDisableRemote</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x26</span>
  <span class="n">body_length</span> <span class="o">=</span> <span class="mi">14</span></div>
<div class="viewcode-block" id="ChangeRemoteID"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ChangeRemoteID">[docs]</a><span class="k">class</span> <span class="nc">ChangeRemoteID</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x27</span>
</div>
<div class="viewcode-block" id="TempBasalDuration"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.TempBasalDuration">[docs]</a><span class="k">class</span> <span class="nc">TempBasalDuration</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x16</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="p">])</span>
<div class="viewcode-block" id="TempBasalDuration.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.TempBasalDuration.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">basal</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;duration (min)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">30</span><span class="p">,</span> <span class="p">}</span>
    <span class="k">return</span> <span class="n">basal</span></div></div>
<div class="viewcode-block" id="TempBasal"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.TempBasal">[docs]</a><span class="k">class</span> <span class="nc">TempBasal</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x33</span>
  <span class="n">body_length</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="p">])</span>
<div class="viewcode-block" id="TempBasal.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.TempBasal.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">basal</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;rate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">40.0</span><span class="p">,</span> <span class="p">}</span>
    <span class="k">return</span> <span class="n">basal</span>
</div></div>
<div class="viewcode-block" id="LowReservoir"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.LowReservoir">[docs]</a><span class="k">class</span> <span class="nc">LowReservoir</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; rec = LowReservoir( LowReservoir._test_1[:2] )</span>
<span class="sd">  &gt;&gt;&gt; decoded = rec.parse(LowReservoir._test_1)</span>
<span class="sd">  &gt;&gt;&gt; print str(rec)</span>
<span class="sd">  LowReservoir 2012-12-07T11:02:43 head[2], body[0] op[0x34]</span>

<span class="sd">  &gt;&gt;&gt; print pformat(decoded)</span>
<span class="sd">  {&#39;amount&#39;: 20.0}</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x34</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span>
                        <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="p">])</span>
<div class="viewcode-block" id="LowReservoir.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.LowReservoir.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">reservoir</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;amount&#39;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">10.0</span> <span class="p">}</span>
    <span class="k">return</span> <span class="n">reservoir</span></div></div>
<div class="viewcode-block" id="Bolus"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Bolus">[docs]</a><span class="k">class</span> <span class="nc">Bolus</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; rec = Bolus(Bolus._test_1[:4])</span>
<span class="sd">  &gt;&gt;&gt; decoded = rec.parse(Bolus._test_1)</span>
<span class="sd">  &gt;&gt;&gt; print str(rec)</span>
<span class="sd">  Bolus 2012-12-18T15:05:28 head[4], body[0] op[0x01]</span>

<span class="sd">  &gt;&gt;&gt; print pformat(decoded)</span>
<span class="sd">  {&#39;amount&#39;: 5.6, &#39;dual_component&#39;: &#39;??&#39;, &#39;programmed&#39;: 5.6, &#39;type&#39;: &#39;??&#39;}</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
                        <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="p">])</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x01</span>
  <span class="n">head_length</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="Bolus.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.Bolus.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">dose</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;amount&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">10.0</span><span class="p">,</span>
             <span class="s">&#39;programmed&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mf">10.0</span><span class="p">,</span>
             <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;??&#39;</span><span class="p">,</span>
             <span class="s">&#39;dual_component&#39;</span><span class="p">:</span> <span class="s">&#39;??&#39;</span><span class="p">,</span>
           <span class="p">}</span>
    <span class="k">return</span> <span class="n">dose</span>
</div></div>
<div class="viewcode-block" id="BolusWizard"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.BolusWizard">[docs]</a><span class="k">class</span> <span class="nc">BolusWizard</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Decode/parse bolus wizard records.</span>
<span class="sd">  &gt;&gt;&gt; rec = BolusWizard(BolusWizard._test_1[:2])</span>
<span class="sd">  &gt;&gt;&gt; decoded = rec.parse(BolusWizard._test_1)</span>
<span class="sd">  &gt;&gt;&gt; print str(rec)</span>
<span class="sd">  BolusWizard 2013-01-20T13:07:45 head[2], body[13] op[0x5b]</span>
<span class="sd">  &gt;&gt;&gt; print pformat(decoded)</span>
<span class="sd">  {&#39;_byte[5]&#39;: 0,</span>
<span class="sd">   &#39;_byte[7]&#39;: 0,</span>
<span class="sd">   &#39;bg&#39;: 108,</span>
<span class="sd">   &#39;bg_target_high&#39;: 125,</span>
<span class="sd">   &#39;bg_target_low&#39;: 106,</span>
<span class="sd">   &#39;bolus_estimate&#39;: 1.1,</span>
<span class="sd">   &#39;carb_input&#39;: 15,</span>
<span class="sd">   &#39;carb_ratio&#39;: 13,</span>
<span class="sd">   &#39;correction_estimate&#39;: 0.0,</span>
<span class="sd">   &#39;food_estimate&#39;: 1.1,</span>
<span class="sd">   &#39;sensitivity&#39;: 45,</span>
<span class="sd">   &#39;unabsorbed_insulin_count&#39;: &#39;??&#39;,</span>
<span class="sd">   &#39;unabsorbed_insulin_total&#39;: 4.8,</span>
<span class="sd">   &#39;unknown_byte[10]&#39;: 0,</span>
<span class="sd">   &#39;unknown_byte[8]&#39;: 0}</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># missing unabsorbed_insulin_count = 4</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span>
                        <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span>
                        <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
                        <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="p">])</span>

  <span class="n">_test_2</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span>
                        <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span>
                        <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
                        <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="p">])</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x5b</span>
  <span class="n">body_length</span> <span class="o">=</span> <span class="mi">13</span>
<div class="viewcode-block" id="BolusWizard.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.BolusWizard.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parse_time</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">bg</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">BangInt</span><span class="p">([</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span>
    <span class="n">carb_input</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c"># XXX: I have no idea if this is correct; it seems to produce correct results.</span>
    <span class="n">correction</span> <span class="o">=</span> <span class="p">(</span> <span class="n">twos_comp</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">8</span> <span class="p">)</span>
                 <span class="o">+</span> <span class="n">twos_comp</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span>
    <span class="n">wizard</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;bg&#39;</span><span class="p">:</span> <span class="n">bg</span><span class="p">,</span> <span class="s">&#39;carb_input&#39;</span><span class="p">:</span> <span class="n">carb_input</span><span class="p">,</span>
               <span class="s">&#39;carb_ratio&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
               <span class="s">&#39;bg_target_low&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
               <span class="s">&#39;bg_target_high&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">12</span><span class="p">]),</span>
               <span class="s">&#39;bolus_estimate&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span><span class="o">/</span><span class="mf">10.0</span><span class="p">,</span>
               <span class="s">&#39;food_estimate&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="o">/</span><span class="mf">10.0</span><span class="p">,</span>
               <span class="s">&#39;unabsorbed_insulin_total&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span><span class="o">/</span><span class="mf">10.0</span><span class="p">,</span>
               <span class="s">&#39;unabsorbed_insulin_count&#39;</span><span class="p">:</span> <span class="s">&#39;??&#39;</span><span class="p">,</span>
               <span class="s">&#39;correction_estimate&#39;</span><span class="p">:</span> <span class="n">correction</span><span class="p">,</span>
               <span class="s">&#39;_byte[5]&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
               <span class="s">&#39;_byte[7]&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span> <span class="c">#</span>
               <span class="s">&#39;unknown_byte[8]&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
               <span class="s">&#39;unknown_byte[10]&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
               <span class="c"># &#39;??&#39;: &#39;??&#39;,</span>
               <span class="c"># &#39;unabsorbed_insulin_total&#39;: int(self.body[9])/10.0,</span>
               <span class="c"># &#39;food_estimate&#39;: int(self.body[0]),</span>
             <span class="p">}</span>
    <span class="k">return</span> <span class="n">wizard</span>
</div></div>
<div class="viewcode-block" id="twos_comp"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.twos_comp">[docs]</a><span class="k">def</span> <span class="nf">twos_comp</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">bits</span><span class="p">):</span>
    <span class="c"># http://stackoverflow.com/a/9147327</span>
    <span class="sd">&quot;&quot;&quot;compute the 2&#39;s compliment of int value val&quot;&quot;&quot;</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">val</span><span class="o">&amp;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">bits</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">bits</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</div>
<div class="viewcode-block" id="decode_unabsorbed"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.decode_unabsorbed">[docs]</a><span class="k">def</span> <span class="nf">decode_unabsorbed</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span><span class="n">strokes</span><span class="o">=</span><span class="mf">40.0</span><span class="p">):</span>
  <span class="n">unabsorbed</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;amount&#39;</span><span class="p">:</span> <span class="n">amount</span><span class="o">/</span><span class="n">strokes</span><span class="p">,</span>
                 <span class="s">&#39;age&#39;</span><span class="p">:</span> <span class="n">age</span><span class="p">,</span>
                 <span class="s">&#39;curve&#39;</span><span class="p">:</span> <span class="n">curve</span><span class="p">,</span> <span class="p">}</span>
  <span class="k">return</span> <span class="n">unabsorbed</span>
</div>
<div class="viewcode-block" id="UnabsorbedInsulinBolus"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.UnabsorbedInsulinBolus">[docs]</a><span class="k">class</span> <span class="nc">UnabsorbedInsulinBolus</span><span class="p">(</span><span class="n">VariableHead</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &gt;&gt;&gt; rec = UnabsorbedInsulinBolus( UnabsorbedInsulinBolus._test_1[:2] )</span>
<span class="sd">  &gt;&gt;&gt; print str(rec)</span>
<span class="sd">  UnabsorbedInsulinBolus unknown head[2], body[0] op[0x5c]</span>

<span class="sd">  &gt;&gt;&gt; print pformat(rec.parse( UnabsorbedInsulinBolus._test_1 ))</span>
<span class="sd">  [{&#39;age&#39;: 78, &#39;amount&#39;: 1.25, &#39;curve&#39;: 4},</span>
<span class="sd">   {&#39;age&#39;: 88, &#39;amount&#39;: 0.95, &#39;curve&#39;: 4}]</span>

<span class="sd">  &gt;&gt;&gt; rec = UnabsorbedInsulinBolus( UnabsorbedInsulinBolus._test_2[:2] )</span>
<span class="sd">  &gt;&gt;&gt; print str(rec)</span>
<span class="sd">  UnabsorbedInsulinBolus unknown head[2], body[0] op[0x5c]</span>

<span class="sd">  &gt;&gt;&gt; print pformat(rec.parse( UnabsorbedInsulinBolus._test_2 ))</span>
<span class="sd">  [{&#39;age&#39;: 60, &#39;amount&#39;: 2.6, &#39;curve&#39;: 4},</span>
<span class="sd">   {&#39;age&#39;: 160, &#39;amount&#39;: 2.5, &#39;curve&#39;: 4}]</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_test_1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
                        <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="p">])</span>

  <span class="n">_test_2</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
                        <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span>
                        <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="p">])</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x5c</span>
  <span class="n">date_length</span> <span class="o">=</span> <span class="mi">0</span>
<div class="viewcode-block" id="UnabsorbedInsulinBolus.decode"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.UnabsorbedInsulinBolus.decode">[docs]</a>  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">doses</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
    <span class="k">while</span> <span class="n">raw</span><span class="p">:</span>
      <span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">raw</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
      <span class="n">doses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">decode_unabsorbed</span><span class="p">(</span><span class="o">*</span><span class="n">head</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">raw</span> <span class="o">=</span> <span class="n">tail</span>
    <span class="k">return</span> <span class="n">doses</span>
</div></div>
<div class="viewcode-block" id="ChangeUtility"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ChangeUtility">[docs]</a><span class="k">class</span> <span class="nc">ChangeUtility</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x63</span></div>
<div class="viewcode-block" id="ChangeTimeDisplay"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.ChangeTimeDisplay">[docs]</a><span class="k">class</span> <span class="nc">ChangeTimeDisplay</span><span class="p">(</span><span class="n">KnownRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x64</span>
</div>
<span class="n">_confirmed</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Bolus</span><span class="p">,</span> <span class="n">Prime</span><span class="p">,</span> <span class="n">NoDelivery</span><span class="p">,</span> <span class="n">ResultTotals</span><span class="p">,</span> <span class="n">ChangeBasalProfile</span><span class="p">,</span>
               <span class="n">ClearAlarm</span><span class="p">,</span> <span class="n">SelectBasalProfile</span><span class="p">,</span> <span class="n">TempBasalDuration</span><span class="p">,</span> <span class="n">ChangeTime</span><span class="p">,</span>
               <span class="n">NewTimeSet</span><span class="p">,</span> <span class="n">LowBattery</span><span class="p">,</span> <span class="n">Battery</span><span class="p">,</span> <span class="n">PumpSuspend</span><span class="p">,</span>
               <span class="n">PumpResume</span><span class="p">,</span> <span class="n">CalBGForPH</span><span class="p">,</span> <span class="n">Rewind</span><span class="p">,</span> <span class="n">EnableDisableRemote</span><span class="p">,</span>
               <span class="n">ChangeRemoteID</span><span class="p">,</span> <span class="n">TempBasal</span><span class="p">,</span> <span class="n">LowReservoir</span><span class="p">,</span> <span class="n">BolusWizard</span><span class="p">,</span>
               <span class="n">UnabsorbedInsulinBolus</span><span class="p">,</span> <span class="n">ChangeUtility</span><span class="p">,</span> <span class="n">ChangeTimeDisplay</span> <span class="p">]</span>

<div class="viewcode-block" id="hack1"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.hack1">[docs]</a><span class="k">class</span> <span class="nc">hack1</span><span class="p">(</span><span class="n">InvalidRecord</span><span class="p">):</span>
  <span class="n">opcode</span> <span class="o">=</span> <span class="mh">0x6d</span>
  <span class="n">head_length</span> <span class="o">=</span> <span class="mi">46</span>
</div>
<span class="n">_confirmed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hack1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_confirmed</span><span class="p">:</span>
  <span class="n">_known</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">opcode</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

<span class="k">del</span> <span class="n">x</span>

<div class="viewcode-block" id="suggest"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.suggest">[docs]</a><span class="k">def</span> <span class="nf">suggest</span><span class="p">(</span><span class="n">head</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">klass</span> <span class="o">=</span> <span class="n">_known</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Base</span><span class="p">)</span>
  <span class="n">record</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">record</span>
</div>
<div class="viewcode-block" id="parse_record"><a class="viewcode-back" href="../../api/decocare.html#decocare.history.parse_record">[docs]</a><span class="k">def</span> <span class="nf">parse_record</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">)):</span>
  <span class="c"># head    = bytearray(fd.read(2))</span>
  <span class="n">date</span>    <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">)</span>
  <span class="n">body</span>    <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">)</span>
  <span class="n">record</span>  <span class="o">=</span> <span class="n">suggest</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
  <span class="n">remaining</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">head_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">remaining</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">head</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">remaining</span><span class="p">)))</span>
  <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">date_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">date</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">date_length</span><span class="p">)))</span>
  <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">body_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">body</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">body_length</span><span class="p">)))</span>
  <span class="n">record</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span> <span class="n">head</span> <span class="o">+</span> <span class="n">date</span> <span class="o">+</span> <span class="n">body</span> <span class="p">)</span>
  <span class="c"># print str(record)</span>
  <span class="c"># print record.pformat(prefix=str(record) )</span>
  <span class="k">return</span> <span class="n">record</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">doctest</span>
  <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span> <span class="p">)</span>

<span class="c">#####</span>
<span class="c"># EOF</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">insulaudit:decoding-carelink 0.0.3 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Insulaudit contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>